<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Session 1: Introduction to R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Ben Raymond, Adrien Ickowicz" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="extra/extra.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">


layout: true

&lt;div class="my-footer"&gt;
  &lt;div class="my-footer-box"&gt;&lt;a href="https://openvolley.org/"&gt;&lt;img style="display:inline;" src="extra/ovoutline-w.png"/&gt;openvolley.org&lt;/a&gt;&lt;/div&gt;
  &lt;div class="my-footer-box"&gt;&lt;a href="https://https://volleyball.ca/"&gt;&lt;img src="extra/vc-w-wide.png"/&gt;&lt;/a&gt;&lt;/div&gt;
  &lt;div class="my-footer-box"&gt;&lt;a href="https://untan.gl/"&gt;&lt;img src="extra/su_title-w.png"/&gt;&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;

---



class: inverse, logo, center

&lt;img src="extra/3logo2.png" style="width:65%; margin-bottom:50px;" /&gt;

## Session 1: Introduction to R

### Ben Raymond, Adrien Ickowicz

##### with valuable contributions from many others...


---
## What are we going to talk about

- introductions
- the openvolley project
- Science Untangled
- R in general
- aims for this workshop
- using R, first details


---
## The openvolley project

2016-ish to now

#### Aim

To develop and foster volleyball analytics approaches that are &lt;strong&gt;*informative*&lt;/strong&gt;, &lt;strong&gt;*accessible*&lt;/strong&gt;, and &lt;strong&gt;*advanced*&lt;/strong&gt;.

Do this by developing &lt;strong&gt;*technical*&lt;/strong&gt; and &lt;strong&gt;*community*&lt;/strong&gt; resources


---
## The openvolley project

- software, primarily R-based
  - family of packages (code building blocks) ... "more but smaller" approach
  - apps
  - documentation

- other community resources
  - example analyses, code snippets
  - discussion fora (Slack)
  - data

---
## The openvolley project

Contribute:

- code snippets, examples of use
- data (scout files)
- bug reports, improvements to documentation
- or anything else

---
## openvolley software overview

**Scouting:** &lt;span class="pkg"&gt;ovscout&lt;/span&gt; &lt;span class="nonpkg"&gt;DataVolley, VolleyStation, etc&lt;/span&gt; &lt;span class="nonpkg"&gt;VBStats&lt;/span&gt;

**Other data:** &lt;span class="pkg"&gt;ovdata&lt;/span&gt; &lt;span class="pkg"&gt;fivbvis&lt;/span&gt;

&amp;nbsp;

**Reading data into R:** &lt;span class="pkg"&gt;datavolley&lt;/span&gt; &lt;span class="pkg"&gt;peranavolley&lt;/span&gt; &lt;span class="Rpkg"&gt;rvest&lt;/span&gt;

**Analysis and graphing:** &lt;span class="pkg"&gt;ovlytics&lt;/span&gt; &lt;span class="pkg"&gt;volleysim&lt;/span&gt; &lt;span class="Rpkg"&gt;ggplot2&lt;/span&gt;

**Reporting and sharing:** &lt;span class="pkg"&gt;volleyreport&lt;/span&gt; &lt;span class="pkg"&gt;ovplayer&lt;/span&gt; &lt;span class="Rpkg"&gt;Shiny&lt;/span&gt; &lt;span class="Rpkg"&gt;rmarkdown&lt;/span&gt;

**Video review and analysis:** &lt;span class="pkg"&gt;ovideo&lt;/span&gt; &lt;span class="pkg"&gt;ovva&lt;/span&gt;

**Computer vision and AI:** &lt;span class="pkg"&gt;ovml&lt;/span&gt;

.footnote[**Key:** &lt;span class="pkg"&gt;openvolley R package&lt;/span&gt; &lt;span class="Rpkg"&gt;other R package&lt;/span&gt; &lt;span class="nonpkg"&gt;non-R software&lt;/span&gt;]

---

## Why R?

&lt;img style="float:right;clear:none;width:25%" src="extra/Rlogo.png" /&gt;

Reproducible, shareable code

Rich functionality for data handling, graphics, apps, report generation

Open source and free

Community

Traditional stronghold for statistical analysis

Package ecosystem (~19,000 on CRAN, more on Github, Bioconductor, elsewhere)

... on the down side: learning curve?

The openvolley project aims to lower that barrier

---
## Science Untangled

Volleyball analytics apps: https://apps.untan.gl

&lt;img src="extra/su_apps.png" style="width:100%" /&gt;

---
## Aims for this workshop

We hope to give you a much better idea of what can be done in R, and (improved) skills in using it.

You won't be an expert by the end of this workshop!

We'll be describing

- code building blocks (that you can write your own code with)

  as well as

- tools that you can use without writing much or even any code.

---
## R sessions for this workshop

1. Introductions and a general overview of R.

1. Focus on the `datavolley` package in R, reading your data in and working with it.

1. Different methods of conveying information (tables, graphs, court plots, video) and how to generate these in R. Heatmaps, video playlists, and more.

1. Advanced analytics to support decision making, match preparation, and similar. Examples of statistical models, simulating matches.

1. Other odds and ends: computer vision and video processing, a brief introduction to R Shiny apps.



---
## Session 1 setup

1. Have R and RStudio installed:

  https://www.rstudio.com/products/rstudio/download/#download

2. Install the tidyverse packages:
  
  ```r
  install.packages("tidyverse")
  ```
3. Clone the workshop repository

  From the RStudio menu:

    -  `File` -&gt; `New Project ...` -&gt; `Version Control` -&gt; `Git`

    -  Repository URL: https://github.com/openvolley/R_workshop_2022

  Select the location to save it and `Create Project`

---
## R &amp;mdash; Overview

&lt;img style="float:right;clear:none;width:25%" src="extra/Rlogo.png" /&gt;

- commands and scripts
- base functionality and packages

---
## R &amp;mdash; Data types:

- numeric
- integer
- logical
- character
- factor
- Date


- converting: `as.whatever()`

- automatic conversion: `2 + TRUE`, but not e.g. `2 + "1"`

- `NA`, `NaN`, `Inf`

---
## R &amp;mdash; Variables, assignment

evaluating without assigning just prints the result to the console:


```r
"blah"
```

```
## [1] "blah"
```

--

To save the result, assign it:

`x &lt;- 1`

assigns the value `1` to the variable `x`.

This is (broadly) the same as using `x = 1` ...

... but note that `x == 1` is very different.

---
## R &amp;mdash; Data structures: vectors

- constructing with e.g. `c()`
- sequences
- indexing

---
## R &amp;mdash; Arithmetic operations

- range, min, max, unique

- `NA` handling


---
## R &amp;mdash; Data structures: lists

- constructing

- names

- indexing: `[ ]`, `[[ ]]`, and `$`

---
## R &amp;mdash; Data structures: data frames and tibbles

A tibble is a table-like, rectangular data structure:


```r
library(dplyr)
x &lt;- tibble(Var1 = c(1, 2, 2),
            Var2 = c("cat", "dog", "rabbit"))
View(x)
```


| Var1|Var2   |
|----:|:------|
|    1|cat    |
|    2|dog    |
|    2|rabbit |

- tibbles are arranged by `[row, column]`

---
## R &amp;mdash; Data structures: data frames and tibbles

- subset by row


```r
x[3, ]
```

```
## # A tibble: 1 × 2
##    Var1 Var2  
##   &lt;dbl&gt; &lt;chr&gt; 
## 1     2 rabbit
```

- by column number


```r
x[, 2]
```

```
## # A tibble: 3 × 1
##   Var2  
##   &lt;chr&gt; 
## 1 cat   
## 2 dog   
## 3 rabbit
```

---
## R &amp;mdash; Data structures: data frames and tibbles

- extract a column by name


```r
x$Var2
```

```
## [1] "cat"    "dog"    "rabbit"
```

- or by number


```r
x[[2]]
```

```
## [1] "cat"    "dog"    "rabbit"
```



---
## R &amp;mdash; Data structures: data frames and tibbles

- a `data.frame` is almost the same as a data.frame, but with some differences in behaviour


```r
y &lt;- data.frame(Var1 = c(1, 2, 2),
                Var2 = c("cat", "dog", "rabbit"))
```

---
## R &amp;mdash; Programming:

- control: `if` statements
- repetition: `for` loops, `lapply` and `sapply`
- writing functions

---
## R &amp;mdash; Packages

https://cran.r-project.org/ has ~19k packages, more on GitHub and other package repositories.

Install packages from CRAN with


```r
install.packages(c("package1", "package2"))`
```

Or from GitHub with


```r
library(remotes)
install_github("owner/repo")
```

(Many CRAN packages are also on GitHub, with the development version on GitHub and the stable release on CRAN.)

---
## R &amp;mdash; Packages

- a package only needs to be installed once (or when needing an update).
- but needs to be loaded each session before calling any of its functions:


```r
library(dadjokes)
dadjoke()
```

&gt; I'm so good at sleeping, I can do it with my eyes closed!

&lt;br /&gt;

Or use `pkg::fun()` to refer to function `fun` in package `pkg`, even without loading the package first:


```r
dadjokes::dadjoke()
```
&gt; I like telling Dad jokes.
&gt;
&gt; Sometimes he laughs!


---
## R &amp;mdash; Tidyverse packages

See https://tidyverse.org. A set of packages that provide a (relatively) consistent syntax and user experience, designed for many of the data manipulation and analysis tasks that we need to do.

Install with:


```r
install.packages("tidyverse")
```

The main tidyverse packages that we will be using are:
- dplyr (data manipulation)
- ggplot2 (plotting)
- stringr (dealing with strings)
- lubridate (dates and times)

---
## R &amp;mdash; Tidyverse packages

Load core tidyverse packages in one go:


```r
library(tidyverse)
```

```
── Attaching packages ────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.1 ──
✓ ggplot2 3.3.5     ✓ purrr   0.3.4
✓ tibble  3.1.6     ✓ dplyr   1.0.8
✓ tidyr   1.2.0     ✓ stringr 1.4.0
✓ readr   2.1.2     ✓ forcats 0.5.1
── Conflicts ───────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
```

&lt;br /&gt;

Or load specific packages:


```r
library(dplyr)
library(ggplot2)
```


---
## R &amp;mdash; dplyr


```r
library(tidyverse)

x &lt;- read_csv("example_data/VNL_Women_2021.csv")
x
```

```
## # A tibble: 16 × 36
##    Team   Status N_sets_played Sets_won Points_won SO_TOT SO_JUMP
##    &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1 Belgi… Chall…            61     44.3       49     60.8    63.6
##  2 Brazil Core              52     80.8       56.8   71.3    74.3
##  3 Canada Chall…            56     30.4       45.4   54.1    54.9
##  4 China  Core              56     62.5       52.1   62.7    76.1
##  5 Domin… Chall…            59     57.6       50.2   63.1    67  
##  6 Germa… Core              54     40.7       48.8   60      55.2
##  7 Italy  Core              59     40.7       48.7   62.8    65.2
##  8 Japan  Core              54     66.7       52.8   66.1    69.9
##  9 Korea  Core              56     28.6       47.2   58.3    61.3
## 10 Nethe… Core              56     53.6       51     64.6    71.6
## # … with 6 more rows, and 29 more variables: SO_FLOAT &lt;dbl&gt;,
## #   mod_SO &lt;dbl&gt;, EXP_SO &lt;dbl&gt;, R_POS &lt;dbl&gt;, FBSO &lt;dbl&gt;,
## #   OPP_FBSO &lt;dbl&gt;, KILL &lt;dbl&gt;, OPP_KILL &lt;dbl&gt;, EFF &lt;dbl&gt;,
## #   TRANS_KILL &lt;dbl&gt;, TRANS_OPP_KILL &lt;dbl&gt;, TRANS_KILL_BP &lt;dbl&gt;,
## #   TRANS_EFF &lt;dbl&gt;, REC_ATT_KILL &lt;dbl&gt;, REC_ATT_EFF &lt;dbl&gt;,
## #   R_POS_KILL &lt;dbl&gt;, BP_TOT &lt;dbl&gt;, BP_JUMP &lt;dbl&gt;,
## #   BP_FLOAT &lt;dbl&gt;, mod_BP &lt;dbl&gt;, EXP_BP &lt;dbl&gt;, ACE &lt;dbl&gt;, …
```

---
## R &amp;mdash; dplyr

The pipe operator `%&gt;%`


```r
intermediate_result &lt;- do_something(data)
final_result &lt;- do_something_else(intermediate_result)
```

equivalent to



```r
final_result &lt;- data %&gt;% do_something %&gt;% do_something_else
```

---
## R &amp;mdash; dplyr

Filtering rows (`filter`)


```r
x %&gt;% filter(N_sets_played &gt;= 60)
```

```
## # A tibble: 2 × 36
##   Team    Status N_sets_played Sets_won Points_won SO_TOT SO_JUMP
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1 Belgium Chall…            61     44.3       49     60.8    63.6
## 2 Poland  Chall…            60     40         49.5   63.1    54.5
## # … with 29 more variables: SO_FLOAT &lt;dbl&gt;, mod_SO &lt;dbl&gt;,
## #   EXP_SO &lt;dbl&gt;, R_POS &lt;dbl&gt;, FBSO &lt;dbl&gt;, OPP_FBSO &lt;dbl&gt;,
## #   KILL &lt;dbl&gt;, OPP_KILL &lt;dbl&gt;, EFF &lt;dbl&gt;, TRANS_KILL &lt;dbl&gt;,
## #   TRANS_OPP_KILL &lt;dbl&gt;, TRANS_KILL_BP &lt;dbl&gt;, TRANS_EFF &lt;dbl&gt;,
## #   REC_ATT_KILL &lt;dbl&gt;, REC_ATT_EFF &lt;dbl&gt;, R_POS_KILL &lt;dbl&gt;,
## #   BP_TOT &lt;dbl&gt;, BP_JUMP &lt;dbl&gt;, BP_FLOAT &lt;dbl&gt;, mod_BP &lt;dbl&gt;,
## #   EXP_BP &lt;dbl&gt;, ACE &lt;dbl&gt;, BLOCK_BP &lt;dbl&gt;, …
```

---
## R &amp;mdash; dplyr

Multiple filtering conditions with `&amp;` ("and") and `|` ("or")


```r
x %&gt;% filter(N_sets_played &gt;= 60 | Sets_won &gt; 70)
```

```
## # A tibble: 4 × 36
##   Team    Status N_sets_played Sets_won Points_won SO_TOT SO_JUMP
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1 Belgium Chall…            61     44.3       49     60.8    63.6
## 2 Brazil  Core              52     80.8       56.8   71.3    74.3
## 3 Poland  Chall…            60     40         49.5   63.1    54.5
## 4 USA     Core              49     85.7       56.3   71.4    74.1
## # … with 29 more variables: SO_FLOAT &lt;dbl&gt;, mod_SO &lt;dbl&gt;,
## #   EXP_SO &lt;dbl&gt;, R_POS &lt;dbl&gt;, FBSO &lt;dbl&gt;, OPP_FBSO &lt;dbl&gt;,
## #   KILL &lt;dbl&gt;, OPP_KILL &lt;dbl&gt;, EFF &lt;dbl&gt;, TRANS_KILL &lt;dbl&gt;,
## #   TRANS_OPP_KILL &lt;dbl&gt;, TRANS_KILL_BP &lt;dbl&gt;, TRANS_EFF &lt;dbl&gt;,
## #   REC_ATT_KILL &lt;dbl&gt;, REC_ATT_EFF &lt;dbl&gt;, R_POS_KILL &lt;dbl&gt;,
## #   BP_TOT &lt;dbl&gt;, BP_JUMP &lt;dbl&gt;, BP_FLOAT &lt;dbl&gt;, mod_BP &lt;dbl&gt;,
## #   EXP_BP &lt;dbl&gt;, ACE &lt;dbl&gt;, BLOCK_BP &lt;dbl&gt;, …
```

---
## R &amp;mdash; dplyr

Multiple filtering conditions with `&amp;` ("and") and `|` ("or")


```r
x %&gt;% filter(N_sets_played &gt;= 60 &amp; Sets_won &gt; 70)
```

```
## # A tibble: 0 × 36
## # … with 36 variables: Team &lt;chr&gt;, Status &lt;chr&gt;,
## #   N_sets_played &lt;dbl&gt;, Sets_won &lt;dbl&gt;, Points_won &lt;dbl&gt;,
## #   SO_TOT &lt;dbl&gt;, SO_JUMP &lt;dbl&gt;, SO_FLOAT &lt;dbl&gt;, mod_SO &lt;dbl&gt;,
## #   EXP_SO &lt;dbl&gt;, R_POS &lt;dbl&gt;, FBSO &lt;dbl&gt;, OPP_FBSO &lt;dbl&gt;,
## #   KILL &lt;dbl&gt;, OPP_KILL &lt;dbl&gt;, EFF &lt;dbl&gt;, TRANS_KILL &lt;dbl&gt;,
## #   TRANS_OPP_KILL &lt;dbl&gt;, TRANS_KILL_BP &lt;dbl&gt;, TRANS_EFF &lt;dbl&gt;,
## #   REC_ATT_KILL &lt;dbl&gt;, REC_ATT_EFF &lt;dbl&gt;, R_POS_KILL &lt;dbl&gt;, …
```

---
## R &amp;mdash; dplyr

Selecting columns (`select`)


```r
x %&gt;% select(Team, N_sets_played, Sets_won)
```

```
## # A tibble: 16 × 3
##    Team               N_sets_played Sets_won
##    &lt;chr&gt;                      &lt;dbl&gt;    &lt;dbl&gt;
##  1 Belgium                       61     44.3
##  2 Brazil                        52     80.8
##  3 Canada                        56     30.4
##  4 China                         56     62.5
##  5 Dominican Republic            59     57.6
##  6 Germany                       54     40.7
##  7 Italy                         59     40.7
##  8 Japan                         54     66.7
##  9 Korea                         56     28.6
## 10 Netherlands                   56     53.6
## # … with 6 more rows
```

---
## R &amp;mdash; dplyr

Renaming while selecting (`select`)


```r
x %&gt;% select(Team, Played = N_sets_played, Won = Sets_won)
```

```
## # A tibble: 16 × 3
##    Team               Played   Won
##    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
##  1 Belgium                61  44.3
##  2 Brazil                 52  80.8
##  3 Canada                 56  30.4
##  4 China                  56  62.5
##  5 Dominican Republic     59  57.6
##  6 Germany                54  40.7
##  7 Italy                  59  40.7
##  8 Japan                  54  66.7
##  9 Korea                  56  28.6
## 10 Netherlands            56  53.6
## # … with 6 more rows
```

---
## R &amp;mdash; dplyr

Just renaming, keeping all columns (`rename`)


```r
x %&gt;% rename(Played = N_sets_played, Won = Sets_won)
```

```
## # A tibble: 16 × 36
##    Team    Status Played   Won Points_won SO_TOT SO_JUMP SO_FLOAT
##    &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 Belgium Chall…     61  44.3       49     60.8    63.6     60.2
##  2 Brazil  Core       52  80.8       56.8   71.3    74.3     70.8
##  3 Canada  Chall…     56  30.4       45.4   54.1    54.9     54  
##  4 China   Core       56  62.5       52.1   62.7    76.1     61.4
##  5 Domini… Chall…     59  57.6       50.2   63.1    67       62.4
##  6 Germany Core       54  40.7       48.8   60      55.2     60.7
##  7 Italy   Core       59  40.7       48.7   62.8    65.2     62.5
##  8 Japan   Core       54  66.7       52.8   66.1    69.9     65.5
##  9 Korea   Core       56  28.6       47.2   58.3    61.3     57.8
## 10 Nether… Core       56  53.6       51     64.6    71.6     63.5
## # … with 6 more rows, and 28 more variables: mod_SO &lt;dbl&gt;,
## #   EXP_SO &lt;dbl&gt;, R_POS &lt;dbl&gt;, FBSO &lt;dbl&gt;, OPP_FBSO &lt;dbl&gt;,
## #   KILL &lt;dbl&gt;, OPP_KILL &lt;dbl&gt;, EFF &lt;dbl&gt;, TRANS_KILL &lt;dbl&gt;,
## #   TRANS_OPP_KILL &lt;dbl&gt;, TRANS_KILL_BP &lt;dbl&gt;, TRANS_EFF &lt;dbl&gt;,
## #   REC_ATT_KILL &lt;dbl&gt;, REC_ATT_EFF &lt;dbl&gt;, R_POS_KILL &lt;dbl&gt;,
## #   BP_TOT &lt;dbl&gt;, BP_JUMP &lt;dbl&gt;, BP_FLOAT &lt;dbl&gt;, mod_BP &lt;dbl&gt;,
## #   EXP_BP &lt;dbl&gt;, ACE &lt;dbl&gt;, BLOCK_BP &lt;dbl&gt;, …
```

---
## R &amp;mdash; dplyr

Adding or changing columns (`mutate`)


```r
x %&gt;% mutate(Sets_won = N_sets_played / 100,
             Team_abbrev = str_to_upper(str_sub(Team, 1, 3))) %&gt;%
    select(Team, Team_abbrev, N_sets_played, Sets_won)
```

```
## # A tibble: 16 × 4
##    Team               Team_abbrev N_sets_played Sets_won
##    &lt;chr&gt;              &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
##  1 Belgium            BEL                    61     0.61
##  2 Brazil             BRA                    52     0.52
##  3 Canada             CAN                    56     0.56
##  4 China              CHI                    56     0.56
##  5 Dominican Republic DOM                    59     0.59
##  6 Germany            GER                    54     0.54
##  7 Italy              ITA                    59     0.59
##  8 Japan              JAP                    54     0.54
##  9 Korea              KOR                    56     0.56
## 10 Netherlands        NET                    56     0.56
## # … with 6 more rows
```

---
## R &amp;mdash; dplyr

Ordering rows (`arrange`)


```r
x %&gt;% arrange(N_sets_played) %&gt;%
    select(Team, N_sets_played, Sets_won)
```

```
## # A tibble: 16 × 3
##    Team        N_sets_played Sets_won
##    &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
##  1 USA                    49     85.7
##  2 Thailand               51     21.6
##  3 Brazil                 52     80.8
##  4 Germany                54     40.7
##  5 Japan                  54     66.7
##  6 Serbia                 55     36.4
##  7 Canada                 56     30.4
##  8 China                  56     62.5
##  9 Korea                  56     28.6
## 10 Netherlands            56     53.6
## # … with 6 more rows
```

---
## R &amp;mdash; dplyr

Or in descending order with `desc`


```r
x %&gt;% arrange(desc(N_sets_played)) %&gt;%
    select(Team, N_sets_played, Sets_won)
```

```
## # A tibble: 16 × 3
##    Team               N_sets_played Sets_won
##    &lt;chr&gt;                      &lt;dbl&gt;    &lt;dbl&gt;
##  1 Belgium                       61     44.3
##  2 Poland                        60     40  
##  3 Dominican Republic            59     57.6
##  4 Italy                         59     40.7
##  5 Turkey                        58     62.1
##  6 Canada                        56     30.4
##  7 China                         56     62.5
##  8 Korea                         56     28.6
##  9 Netherlands                   56     53.6
## 10 Russia                        56     53.6
## # … with 6 more rows
```

---
## R &amp;mdash; dplyr

Summarizing (`summarize`)


```r
x %&gt;% summarize(Mean_N_sets_played = mean(N_sets_played),
                Max_sets_won = max(Sets_won))
```

```
## # A tibble: 1 × 2
##   Mean_N_sets_played Max_sets_won
##                &lt;dbl&gt;        &lt;dbl&gt;
## 1               55.8         85.7
```

(compare with `mean(x$N_sets_played)` and `max(x$Sets_won)`)

---
## R &amp;mdash; dplyr

Groups (`group_by`)


```r
x %&gt;% group_by(Status)
```

```
## # A tibble: 16 × 36
## # Groups:   Status [2]
##    Team   Status N_sets_played Sets_won Points_won SO_TOT SO_JUMP
##    &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1 Belgi… Chall…            61     44.3       49     60.8    63.6
##  2 Brazil Core              52     80.8       56.8   71.3    74.3
##  3 Canada Chall…            56     30.4       45.4   54.1    54.9
##  4 China  Core              56     62.5       52.1   62.7    76.1
##  5 Domin… Chall…            59     57.6       50.2   63.1    67  
##  6 Germa… Core              54     40.7       48.8   60      55.2
##  7 Italy  Core              59     40.7       48.7   62.8    65.2
##  8 Japan  Core              54     66.7       52.8   66.1    69.9
##  9 Korea  Core              56     28.6       47.2   58.3    61.3
## 10 Nethe… Core              56     53.6       51     64.6    71.6
## # … with 6 more rows, and 29 more variables: SO_FLOAT &lt;dbl&gt;,
## #   mod_SO &lt;dbl&gt;, EXP_SO &lt;dbl&gt;, R_POS &lt;dbl&gt;, FBSO &lt;dbl&gt;,
## #   OPP_FBSO &lt;dbl&gt;, KILL &lt;dbl&gt;, OPP_KILL &lt;dbl&gt;, EFF &lt;dbl&gt;,
## #   TRANS_KILL &lt;dbl&gt;, TRANS_OPP_KILL &lt;dbl&gt;, TRANS_KILL_BP &lt;dbl&gt;,
## #   TRANS_EFF &lt;dbl&gt;, REC_ATT_KILL &lt;dbl&gt;, REC_ATT_EFF &lt;dbl&gt;,
## #   R_POS_KILL &lt;dbl&gt;, BP_TOT &lt;dbl&gt;, BP_JUMP &lt;dbl&gt;,
## #   BP_FLOAT &lt;dbl&gt;, mod_BP &lt;dbl&gt;, EXP_BP &lt;dbl&gt;, ACE &lt;dbl&gt;, …
```

---
## R &amp;mdash; dplyr

Operating on groups


```r
x %&gt;% group_by(Status) %&gt;%
    summarize(Mean_N_sets_played = mean(N_sets_played),
              Max_sets_won = max(Sets_won))
```

```
## # A tibble: 2 × 3
##   Status     Mean_N_sets_played Max_sets_won
##   &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;
## 1 Challenger               59           57.6
## 2 Core                     54.7         85.7
```

---
## R &amp;mdash; dplyr

Operating on groups


```r
x %&gt;% group_by(Status) %&gt;%
    filter(N_sets_played &gt; mean(N_sets_played)) %&gt;%
    ungroup
```

```
## # A tibble: 9 × 36
##   Team    Status N_sets_played Sets_won Points_won SO_TOT SO_JUMP
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1 Belgium Chall…            61     44.3       49     60.8    63.6
## 2 China   Core              56     62.5       52.1   62.7    76.1
## 3 Italy   Core              59     40.7       48.7   62.8    65.2
## 4 Korea   Core              56     28.6       47.2   58.3    61.3
## 5 Nether… Core              56     53.6       51     64.6    71.6
## 6 Poland  Chall…            60     40         49.5   63.1    54.5
## 7 Russia  Core              56     53.6       50.6   60.5    55.8
## 8 Serbia  Core              55     36.4       46.8   55.7    55.6
## 9 Turkey  Core              58     62.1       51.3   61.7    62.2
## # … with 29 more variables: SO_FLOAT &lt;dbl&gt;, mod_SO &lt;dbl&gt;,
## #   EXP_SO &lt;dbl&gt;, R_POS &lt;dbl&gt;, FBSO &lt;dbl&gt;, OPP_FBSO &lt;dbl&gt;,
## #   KILL &lt;dbl&gt;, OPP_KILL &lt;dbl&gt;, EFF &lt;dbl&gt;, TRANS_KILL &lt;dbl&gt;,
## #   TRANS_OPP_KILL &lt;dbl&gt;, TRANS_KILL_BP &lt;dbl&gt;, TRANS_EFF &lt;dbl&gt;,
## #   REC_ATT_KILL &lt;dbl&gt;, REC_ATT_EFF &lt;dbl&gt;, R_POS_KILL &lt;dbl&gt;,
## #   BP_TOT &lt;dbl&gt;, BP_JUMP &lt;dbl&gt;, BP_FLOAT &lt;dbl&gt;, mod_BP &lt;dbl&gt;,
## #   EXP_BP &lt;dbl&gt;, ACE &lt;dbl&gt;, BLOCK_BP &lt;dbl&gt;, …
```

---
## R &amp;mdash; dplyr

Split - apply - combine

- `bind_rows(lapply(...))`

---
## R &amp;mdash; Base graphics

Plotting with base graphics


```r
plot(x$R_POS, x$FBSO)
```

![](s1-intro-R_files/figure-html/unnamed-chunk-33-1.png)&lt;!-- --&gt;


---
## R &amp;mdash; ggplot

Plotting with `ggplot2`

- "grammar of graphics"
- a plot is treated as a combination of various elements
- minimal usage: provide `ggplot` with:

  - the data to use
  - aesthetics (how to map the variables in the data to visual properties of the plot)
  - geometries (what to show on the plot: points, lines, etc)

---
## R &amp;mdash; ggplot


```r
library(ggplot2)
ggplot(x, aes(x = R_POS, y = FBSO)) + geom_point()
```

![](s1-intro-R_files/figure-html/unnamed-chunk-34-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot


```r
ggplot(x, aes(x = R_POS, y = FBSO)) + geom_point(`aes(col = Team)`)
```
![](s1-intro-R_files/figure-html/unnamed-chunk-36-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot


```r
ggplot(x, aes(x = R_POS, y = FBSO)) + geom_point(`col = "red"`) +
    `geom_text(aes(label = Team))`
```
![](s1-intro-R_files/figure-html/unnamed-chunk-38-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot


```r
ggplot(x, aes(x = R_POS, y = FBSO)) + geom_point(col = "red") +
    geom_text(aes(label = Team)`, hjust = -0.1`)
```
![](s1-intro-R_files/figure-html/unnamed-chunk-40-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot


```r
ggplot(x, aes(x = R_POS, y = FBSO)) + geom_point(col = "red") +
 geom_text(aes(label = Team), hjust = -0.1)` + xlim(c(NA, 58))`
```
![](s1-intro-R_files/figure-html/unnamed-chunk-42-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot


```r
ggplot(x, aes(x = R_POS, y = FBSO)) + geom_point(col = "red") +
 `stat_smooth(method = "lm", se = FALSE) +`
 geom_text(aes(label = Team), hjust = -0.1) + xlim(c(NA, 58))
```
![](s1-intro-R_files/figure-html/unnamed-chunk-44-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot


```r
ggplot(x, aes(x = R_POS, y = FBSO)) + geom_point(col = "red") +
 stat_smooth(method = "lm", se = FALSE) + `theme_bw() +`
 geom_text(aes(label = Team), hjust = -0.1) + xlim(c(NA, 58)) +
 `labs(x = "Positive/perfect reception %", y = "First ball sideout %")`
```
![](s1-intro-R_files/figure-html/unnamed-chunk-46-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot: other geometries


```r
ggplot(x, aes(x = REC_ATT_EFF)) +
    `geom_histogram`(binwidth = 2.5, col = "black", fill = "grey50") +
    theme_bw() + labs(x = "Reception attack efficiency")
```
![](s1-intro-R_files/figure-html/unnamed-chunk-48-1.png)&lt;!-- --&gt;

---
## R &amp;mdash; ggplot: subplots (facets)


```r
ggplot(x, aes(x = REC_ATT_EFF)) +
    geom_histogram(binwidth = 2.5, col = "black", fill = "grey50") +
    `facet_wrap(~Status)` +
    theme_bw() + labs(x = "Reception attack efficiency")
```
![](s1-intro-R_files/figure-html/unnamed-chunk-50-1.png)&lt;!-- --&gt;


---
## R &amp;mdash; Getting help

- on specific functions or packages

  - `? function_name`, equivalently `help("function_name")`
  - package vignettes

- general R

  - the [R-help mailing list](https://stat.ethz.ch/mailman/listinfo/r-help), [stackoverflow.com](https://stackoverflow.com)
- volleyball-specific

  - the openvolley Slack
  - https://openvolley.org/volley-analytics-snippets
  - found a bug? Have a suggestion? Raise an issue on GitHub

---
## R &amp;mdash; Exercises

Open `s1-exercises.Rmd` in Rstudio

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="extra/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

  </body>
</html>
